<Window x:Class="FilesToClipboard.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:FilesToClipboard"
        Title="File Content Collector"
        Width="960" Height="540"
        WindowStartupLocation="Manual"
        Left="100" Top="100"
        Topmost="True"
        Background="{DynamicResource Brush.Surface}"
        Foreground="{DynamicResource Brush.Text}"
        FontFamily="Segoe UI Variable, Segoe UI"
        FontSize="13.5"
        AllowDrop="True"
        DragOver="Window_DragOver"
        Drop="Window_Drop">

    <!-- THEME + STYLES -->
    <Window.Resources>
        <local:FileNameConverter x:Key="FileNameConverter" />

        <!-- Dark palette (default). Light values set from code-behind via ApplyTheme -->
        <SolidColorBrush x:Key="Brush.Surface"        Color="#0F0F10"/>
        <SolidColorBrush x:Key="Brush.Card"           Color="#17171A"/>
        <SolidColorBrush x:Key="Brush.CardBorder"     Color="#26262A"/>
        <SolidColorBrush x:Key="Brush.Text"           Color="#F5F5F7"/>
        <SolidColorBrush x:Key="Brush.TextSecondary"  Color="#B9BBC1"/>
        <SolidColorBrush x:Key="Brush.Input"          Color="#1C1C20"/>
        <SolidColorBrush x:Key="Brush.Accent"         Color="#5B9BFF"/>
        <SolidColorBrush x:Key="Brush.AccentHover"    Color="#4A84DF"/>
        <SolidColorBrush x:Key="Brush.Success"        Color="#2E7D32"/>
        <SolidColorBrush x:Key="Brush.Danger"         Color="#C62828"/>

        <!-- Button base -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Foreground" Value="{DynamicResource Brush.Text}"/>
            <Setter Property="Background" Value="{DynamicResource Brush.Card}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.CardBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Margin" Value="6,0,6,0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="b" CornerRadius="8"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="b" Property="BorderBrush" Value="{DynamicResource Brush.Accent}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="b" Property="Opacity" Value="0.9"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Accent and Danger variants -->
        <Style x:Key="AccentButton" BasedOn="{StaticResource ModernButton}" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource Brush.Accent}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="{x:Null}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="b" CornerRadius="8"
                                Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="b" Property="Background" Value="{DynamicResource Brush.AccentHover}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="b" Property="Opacity" Value="0.9"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="DangerButton" BasedOn="{StaticResource ModernButton}" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource Brush.Danger}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="{x:Null}"/>
        </Style>

        <!-- TextBox -->
        <Style TargetType="TextBox">
            <Setter Property="Foreground" Value="{DynamicResource Brush.Text}"/>
            <Setter Property="Background" Value="{DynamicResource Brush.Input}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.CardBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="bd"
                                CornerRadius="8"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ScrollViewer x:Name="PART_ContentHost"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter TargetName="bd" Property="BorderBrush" Value="{DynamicResource Brush.Accent}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- ListBox "card" -->
        <Style TargetType="ListBox">
            <Setter Property="Background" Value="{DynamicResource Brush.Card}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource Brush.CardBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="6"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBox">
                        <Border CornerRadius="10"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ScrollViewer Focusable="False" Padding="{TemplateBinding Padding}">
                                <ItemsPresenter/>
                            </ScrollViewer>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Item container with rounded hover/selection -->
        <Style TargetType="ListBoxItem">
            <Setter Property="Margin" Value="0,2"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <Border x:Name="bd" CornerRadius="8" Background="Transparent">
                            <ContentPresenter/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#1FFFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#23FFFFFF"/>
                                <Setter Property="Foreground" Value="{DynamicResource Brush.Text}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <!-- LAYOUT -->
    <Grid Margin="14">
        <Grid.RowDefinitions>

            <RowDefinition Height="Auto"/>

            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <!-- Title + Command bar -->
        <Border CornerRadius="12" Background="{DynamicResource Brush.Card}" BorderBrush="{DynamicResource Brush.CardBorder}" BorderThickness="1" Padding="10" Margin="0,0,0,10">
            <DockPanel LastChildFill="False">
                <StackPanel DockPanel.Dock="Left" Orientation="Vertical" Margin="2,0,16,0">
                    <TextBlock Text="File Content Collector" FontSize="18" FontWeight="SemiBold"/>
                    <TextBlock Text="Collect, preview, and export concatenated file contents" Foreground="{DynamicResource Brush.TextSecondary}" FontSize="12"/>
                </StackPanel>

               

                <!-- Primary action -->
                <Button x:Name="btnCopy"
                        DockPanel.Dock="Right" Style="{StaticResource AccentButton}" Margin="6,0,0,0"
                        ToolTip="Copy all selected files' contents with prefix/suffix"
                        Click="btnCopy_Click">
                    <Button.Content>
                        <StackPanel Orientation="Horizontal" Margin="10,0">
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8C8;" Margin="0,0,6,0"/>
                            <TextBlock Text="Copy"/>
                        </StackPanel>
                    </Button.Content>
                </Button>

                <!-- Secondary actions -->
                <StackPanel Orientation="Horizontal">
                    <Button x:Name="btnSelectFiles" Style="{StaticResource ModernButton}" Click="btnSelectFiles_Click" ToolTip="Add files">
                        <StackPanel Orientation="Horizontal" Margin="10,0">
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8E5;" Margin="0,0,6,0"/>
                            <TextBlock Text="Files"/>
                        </StackPanel>
                    </Button>
                    <Button x:Name="btnSelectDirs" Style="{StaticResource ModernButton}" Click="btnSelectDirs_Click" ToolTip="Add directories (recursive)">
                        <StackPanel Orientation="Horizontal"  Margin="10,0">
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE8B7;" Margin="0,0,6,0"/>
                            <TextBlock Text="Folders"/>
                        </StackPanel>
                    </Button>
                    <Button x:Name="btnPastePath" Style="{StaticResource ModernButton}" Click="btnPastePath_Click" ToolTip="Paste path(s) from clipboard">
                        <StackPanel Orientation="Horizontal"  Margin="10,0">
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE77F;" Margin="0,0,6,0"/>
                            <TextBlock Text="Paste Path"/>
                        </StackPanel>
                    </Button>
                    <Button x:Name="btnClear" Style="{StaticResource DangerButton}" Click="btnClear_Click" ToolTip="Clear list">
                        <StackPanel Orientation="Horizontal"  Margin="10,0">
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE74D;" Margin="0,0,6,0"/>
                            <TextBlock Text="Clear"/>
                        </StackPanel>
                    </Button>
                    <Button x:Name="btnClearTexts" Style="{StaticResource ModernButton}" Click="btnClearTexts_Click" ToolTip="Clear prefix/suffix">
                        <StackPanel Orientation="Horizontal" Margin="10,0">
                            <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE894;" Margin="0,0,6,0"/>
                            <TextBlock Text="Clear Texts"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- Prefix -->
        <Border Grid.Row="1" CornerRadius="10" Background="{DynamicResource Brush.Card}" BorderBrush="{DynamicResource Brush.CardBorder}" BorderThickness="1" Padding="8" Margin="0,0,0,10">
            <DockPanel>
                <TextBlock DockPanel.Dock="Left" Text="Prefix" Width="60" VerticalAlignment="Top" Margin="0,4,8,0" Foreground="{DynamicResource Brush.TextSecondary}"/>
                <TextBox x:Name="prefixText" TextWrapping="Wrap" AcceptsReturn="True" VerticalScrollBarVisibility="Auto" MinHeight="52"/>
            </DockPanel>
        </Border>

        <!-- Files list -->
        <Grid Grid.Row="2" Margin="0,0,0,10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>

                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <TextBlock Text="Selected files" Foreground="{DynamicResource Brush.TextSecondary}" Margin="2,0,0,6"/>
            <ListBox x:Name="lstSelectedPaths"
                     Grid.Row="1"
                     ItemsSource="{Binding SelectedPaths}"
                     SelectionMode="Extended"
                     PreviewMouseLeftButtonDown="lstSelectedPaths_PreviewMouseLeftButtonDown"
                     MouseMove="lstSelectedPaths_MouseMove"
                     ScrollViewer.HorizontalScrollBarVisibility="Auto"
                     ScrollViewer.VerticalScrollBarVisibility="Auto">

                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Grid HorizontalAlignment="Stretch">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Remove -->
                            <Button Grid.Column="0" Style="{StaticResource ModernButton}" Padding="8,4" Margin="0,0,10,0"
                                    DataContext="{Binding}" Click="btnRemovePath_Click" ToolTip="Remove">
                                <TextBlock FontFamily="Segoe MDL2 Assets" Text="&#xE711;"/>
                            </Button>

                            <!-- Name + path -->
                            <StackPanel Grid.Column="1">
                                <TextBlock Text="{Binding Converter={StaticResource FileNameConverter}}" Foreground="{DynamicResource Brush.Text}"
                                           FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding}" Foreground="{DynamicResource Brush.TextSecondary}" FontSize="12"/>
                            </StackPanel>

                            <!-- Drag handle icon (visual only) -->
                            <TextBlock Grid.Column="2" FontFamily="Segoe MDL2 Assets" Text="&#xE76F;" Margin="10,0,0,0"
                                       VerticalAlignment="Center" Opacity="0.6"/>
                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </Grid>

        <!-- Suffix -->
        <Border Grid.Row="3" CornerRadius="10" Background="{DynamicResource Brush.Card}" BorderBrush="{DynamicResource Brush.CardBorder}" BorderThickness="1" Padding="8">
            <DockPanel>
                <TextBlock DockPanel.Dock="Left" Text="Suffix" Width="60" VerticalAlignment="Top" Margin="0,4,8,0" Foreground="{DynamicResource Brush.TextSecondary}"/>
                <TextBox x:Name="suffixText" TextWrapping="Wrap" AcceptsReturn="True" VerticalScrollBarVisibility="Auto" MinHeight="52"/>
            </DockPanel>
        </Border>
    </Grid>
</Window>
